(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}})();class Window{constructor(e,s,n){this.manager=n,this.element=document.createElement("div"),this.element.classList.add("window"),this.element.style.top="50%",this.element.style.left="50%",this.element.style.transform="translate(-50%, -50%)",this.element.innerHTML=`
      <div class="window-header">
        <span class="window-title">${e}</span>
        <div class="window-controls">
            <button class="minimize-btn">_</button>
            <button class="close-btn">X</button>
        </div>
      </div>
      <div class="window-content">
        ${s}
      </div>
    `,this.header=this.element.querySelector(".window-header"),this.closeBtn=this.element.querySelector(".close-btn"),this.minimizeBtn=this.element.querySelector(".minimize-btn"),this.setupEvents()}setupEvents(){let e=!1,s,n,t,o;this.header.addEventListener("mousedown",i=>{if(this.element.style.transform&&this.element.style.transform.includes("translate")){const c=this.element.getBoundingClientRect();this.element.style.transform="none",this.element.style.left=c.left+"px",this.element.style.top=c.top+"px"}e=!0,s=i.clientX,n=i.clientY,t=this.element.offsetLeft,o=this.element.offsetTop,this.manager.focusWindow(this),i.preventDefault()}),document.addEventListener("mousemove",i=>{if(e){const c=i.clientX-s,l=i.clientY-n;this.element.style.left=`${t+c}px`,this.element.style.top=`${o+l}px`}}),document.addEventListener("mouseup",()=>{e=!1}),this.element.addEventListener("mousedown",()=>{this.manager.focusWindow(this)}),this.closeBtn.addEventListener("mousedown",i=>i.stopPropagation()),this.minimizeBtn.addEventListener("mousedown",i=>i.stopPropagation()),this.closeBtn.addEventListener("click",i=>{i.stopPropagation(),this.close()}),this.minimizeBtn.addEventListener("click",i=>{i.stopPropagation(),this.minimize()})}minimize(){this.element.style.display="none",this.onMinimize&&this.onMinimize()}restore(){this.element.style.display="flex",this.manager.focusWindow(this),this.onRestore&&this.onRestore()}close(){this.element.remove(),this.onClose&&this.onClose()}}class WindowManager{constructor(e){this.container=e,this.windows=[],this.baseZIndex=100}openWindow(e){const{title:s,content:n}=e,t=new Window(s,typeof n=="string"?n:"",this);return this.container.appendChild(t.element),n instanceof HTMLElement&&t.element.querySelector(".window-content").appendChild(n),this.windows.push(t),this.focusWindow(t),t}focusWindow(e){this.windows=this.windows.filter(s=>s!==e),this.windows.push(e),this.windows.forEach((s,n)=>{s.element.style.zIndex=this.baseZIndex+n})}toggleWindow(e){e.element.style.display==="none"?(e.restore(),this.focusWindow(e)):this.windows[this.windows.length-1]===e?e.minimize():this.focusWindow(e)}}class Dock{constructor(e){this.manager=e,this.element=document.querySelector(".dock"),this.element.innerHTML="",this.launchers=document.createElement("div"),this.launchers.classList.add("dock-launchers"),this.divider=document.createElement("div"),this.divider.classList.add("dock-divider"),this.running=document.createElement("div"),this.running.classList.add("dock-running"),this.element.appendChild(this.launchers),this.element.appendChild(this.divider),this.element.appendChild(this.running)}addApp(e,s,n){const t=document.createElement("div");t.classList.add("dock-icon"),t.title=e,this.styleIcon(t,s),t.addEventListener("mouseenter",()=>{t.style.transform="scale(1.1)"}),t.addEventListener("mouseleave",()=>{t.style.transform="scale(1)"}),t.addEventListener("click",n),this.launchers.appendChild(t)}addMinimizedWindow(e,s){const n=document.createElement("div");return n.classList.add("dock-icon","minimized-icon"),n.title=e.title||"Window",this.styleIcon(n,s),n.addEventListener("click",()=>{e.restore(),n.remove()}),this.running.appendChild(n),n}styleIcon(e,s){s.includes(".")?(e.style.backgroundImage=`url(${s})`,e.style.backgroundSize="cover"):(e.textContent=s,e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.fontSize="24px"),e.style.width="40px",e.style.height="40px",e.style.backgroundColor="#444",e.style.borderRadius="10px",e.style.margin="0 5px",e.style.cursor="pointer",e.style.transition="transform 0.1s"}}class MemoryGame{constructor(){this.element=document.createElement("div"),this.element.classList.add("memory-game"),this.icons=["ðŸŽ","ðŸŒ","ðŸ’","ðŸ‡"],this.cards=[],this.flippedCards=[],this.matchedCount=0,this.isLocked=!1,this.initGame()}initGame(){this.element.innerHTML="",this.matchedCount=0,this.flippedCards=[],this.isLocked=!1;const e=[...this.icons,...this.icons];e.sort(()=>.5-Math.random()),this.cards=e.map((s,n)=>{const t=document.createElement("div");t.classList.add("memory-card"),t.dataset.index=n,t.dataset.icon=s;const o=document.createElement("div");o.classList.add("front"),o.textContent="â“";const i=document.createElement("div");return i.classList.add("back"),i.textContent=s,t.appendChild(o),t.appendChild(i),t.setAttribute("tabindex","0"),t.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),this.handleCardClick(t,s))}),t.addEventListener("click",()=>this.handleCardClick(t,s)),this.element.appendChild(t),t})}handleCardClick(e,s){this.isLocked||e.classList.contains("flipped")||e.classList.contains("matched")||(this.flipCard(e),this.flippedCards.push({card:e,icon:s}),this.flippedCards.length===2&&this.checkMatch())}flipCard(e){e.classList.add("flipped")}unflipCard(e){e.classList.remove("flipped")}checkMatch(){this.isLocked=!0;const[e,s]=this.flippedCards;e.icon===s.icon?(e.card.classList.add("matched"),s.card.classList.add("matched"),this.matchedCount++,this.flippedCards=[],this.isLocked=!1,this.matchedCount===4&&setTimeout(()=>this.showWinOverlay(),500)):setTimeout(()=>{this.unflipCard(e.card),this.unflipCard(s.card),this.flippedCards=[],this.isLocked=!1},1e3)}showWinOverlay(){const e=document.createElement("div");e.classList.add("win-overlay"),e.innerHTML=`
        <div class="win-content">
            <h2>You Won! ðŸŽ‰</h2>
            <button class="play-again-btn">Play Again</button>
        </div>
      `,e.querySelector(".play-again-btn").addEventListener("click",()=>{this.initGame()}),this.element.appendChild(e)}restartAnimation(){this.element.classList.add("shake"),setTimeout(()=>{this.element.classList.remove("shake"),this.initGame()},500)}}class Chat{constructor(){this.element=document.createElement("div"),this.element.classList.add("chat-app"),this.username=localStorage.getItem("chat_username")||null,this.channel=localStorage.getItem("chat_channel")||"General",this.apiKey="eDBE76deU7L0H9mEBgxUKVR0VCnq0XBd",this.socket=null,this.messages=[],this.initUI()}initUI(){this.element.innerHTML="",this.username?(this.renderChat(),this.connect()):this.renderLogin()}renderLogin(){const e=document.createElement("div");e.classList.add("chat-login"),e.innerHTML=`
            <h3>Welcome to Chat</h3>
            <p>Please enter your username:</p>
            <input type="text" class="username-input" placeholder="Username" />
            <button class="login-btn">Join Chat</button>
        `;const s=e.querySelector(".username-input");e.querySelector(".login-btn").addEventListener("click",()=>{const t=s.value.trim();t&&(this.username=t,localStorage.setItem("chat_username",t),this.initUI())}),this.element.appendChild(e)}renderChat(){this.element.innerHTML=`
            <div class="chat-header-bar">
                <span>Channel:</span>
                <input class="channel-input" type="text" value="${this.channel}">
                <button class="change-channel-btn">Set</button>
            </div>
            <div class="chat-messages"></div>
            <div class="chat-input-area">
                <textarea class="chat-text" placeholder="Type a message..."></textarea>
                <button class="send-btn">Send</button>
            </div>
        `,this.messagesContainer=this.element.querySelector(".chat-messages"),this.textarea=this.element.querySelector(".chat-text"),this.sendBtn=this.element.querySelector(".send-btn"),this.channelInput=this.element.querySelector(".channel-input"),this.channelBtn=this.element.querySelector(".change-channel-btn"),this.sendBtn.addEventListener("click",()=>this.sendMessage()),this.textarea.addEventListener("keydown",e=>{e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),this.sendMessage())}),this.channelBtn.addEventListener("click",()=>{const e=this.channelInput.value.trim();e&&e!==this.channel&&(this.channel=e,localStorage.setItem("chat_channel",e),this.messagesContainer.innerHTML="")})}connect(){this.socket&&this.socket.readyState===WebSocket.OPEN||(this.socket=new WebSocket("wss://courselab.lnu.se/message-app/socket"),this.socket.addEventListener("open",()=>{console.log("Connected to Chat Server")}),this.socket.addEventListener("message",e=>{try{const s=JSON.parse(e.data);this.handleMessage(s)}catch{console.error("Invalid JSON",e.data)}}),this.socket.addEventListener("close",()=>{console.log("Disconnected from Chat Server")}),this.socket.addEventListener("error",e=>{console.error("Socket Error",e)}))}handleMessage(e){e.type==="message"&&e.channel===this.channel&&this.addMessageToDOM(e)}sendMessage(){const e=this.textarea.value.trim();if(!e)return;if(!this.socket||this.socket.readyState!==WebSocket.OPEN){alert("Not connected to chat server");return}const s={type:"message",data:e,username:this.username,channel:this.channel,key:this.apiKey};this.socket.send(JSON.stringify(s)),this.textarea.value=""}addMessageToDOM(e){const s=e.username===this.username,n=document.createElement("div");n.classList.add("message"),n.classList.add(s?"message-sent":"message-received"),n.innerHTML=`
            <div class="message-meta">${e.username}</div>
            <div class="message-content">${e.data}</div>
        `,this.messagesContainer.appendChild(n),this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight}}class Calculator{constructor(){this.element=document.createElement("div"),this.element.classList.add("calculator-app"),this.displayValue="",this.initUI()}initUI(){this.element.innerHTML=`
            <div class="calc-display">0</div>
            <div class="calc-buttons">
                <button class="calc-btn operator">C</button>
                <button class="calc-btn operator">/</button>
                <button class="calc-btn operator">*</button>
                <button class="calc-btn operator">-</button>
                <button class="calc-btn">7</button>
                <button class="calc-btn">8</button>
                <button class="calc-btn">9</button>
                <button class="calc-btn operator">+</button>
                <button class="calc-btn">4</button>
                <button class="calc-btn">5</button>
                <button class="calc-btn">6</button>
                <button class="calc-btn equals operator">=</button>
                <button class="calc-btn">1</button>
                <button class="calc-btn">2</button>
                <button class="calc-btn">3</button>
                <button class="calc-btn zero">0</button>
                <button class="calc-btn">.</button>
            </div>
        `,this.display=this.element.querySelector(".calc-display"),this.element.addEventListener("click",a=>{a.target.matches("button")&&this.handleInput(a.target.textContent)})}handleInput(value){if(value==="C")this.displayValue="";else if(value==="=")try{this.displayValue=eval(this.displayValue).toString()}catch{this.displayValue="Error"}else this.displayValue==="Error"&&(this.displayValue=""),this.displayValue+=value;this.display.textContent=this.displayValue||"0"}}function updateTime(){const a=new Date,e=a.toLocaleDateString("en-US",{weekday:"short"}),s=a.getDate(),n=a.toLocaleDateString("en-US",{month:"short"}),t=a.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});document.getElementById("time").innerHTML=`${e} ${s} ${n} &nbsp; ${t}`}setInterval(updateTime,1e3);updateTime();const content=document.querySelector(".content"),windowManager=new WindowManager(content),dock=new Dock(windowManager);dock.addApp("Chat","ðŸ’¬",()=>{const a=new Chat,e=windowManager.openWindow({title:"Chat",content:a.element});e.onMinimize=()=>{dock.addMinimizedWindow(e,"ðŸ’¬")}});dock.addApp("Memory","ðŸ§ ",()=>{const a=new MemoryGame,e=windowManager.openWindow({title:"Memory Game",content:a.element});e.onMinimize=()=>{dock.addMinimizedWindow(e,"ðŸ§ ")}});dock.addApp("Calc","ðŸ”¢",()=>{const a=new Calculator,e=windowManager.openWindow({title:"Calculator",content:a.element});e.onMinimize=()=>{dock.addMinimizedWindow(e,"ðŸ”¢")}});console.log("OS Initialized");const searchInput=document.getElementById("status-search"),searchResults=document.getElementById("search-results");if(searchInput){let e=function(s){searchResults.innerHTML="",s.length===0?searchResults.innerHTML='<div style="padding:10px;color:#666;">No apps found</div>':s.forEach(n=>{const t=document.createElement("div");t.classList.add("search-result-item"),t.innerHTML=`<span>${n.icon}</span> <span>${n.name}</span>`,t.addEventListener("click",()=>{n.action(),searchResults.classList.add("hidden"),searchInput.value=""}),searchResults.appendChild(t)}),searchResults.classList.remove("hidden")};var renderResults=e;const a=[{name:"Chat",icon:"ðŸ’¬",action:()=>document.querySelector('[title="Chat"]').click()},{name:"Memory Game",icon:"ðŸ§ ",action:()=>document.querySelector('[title="Memory"]').click()},{name:"Calculator",icon:"ðŸ”¢",action:()=>document.querySelector('[title="Calc"]').click()}];searchInput.addEventListener("input",s=>{const n=s.target.value.toLowerCase().trim();if(!n){searchResults.classList.add("hidden");return}const t=a.filter(o=>o.name.toLowerCase().includes(n));e(t)}),searchInput.addEventListener("focus",()=>{searchInput.value.trim()&&searchResults.classList.remove("hidden")}),document.addEventListener("click",s=>{!searchInput.contains(s.target)&&!searchResults.contains(s.target)&&searchResults.classList.add("hidden")}),searchInput.addEventListener("keydown",s=>{if(s.key==="Enter"){const n=searchResults.querySelector(".search-result-item");n&&n.click()}s.key==="Escape"&&(searchResults.classList.add("hidden"),searchInput.blur())})}
